<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript Code Parsing & Summary Web App</title>

    <!-- External CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- JSZip -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- Meriyah Parser -->
    <script src="https://unpkg.com/meriyah/dist/meriyah.umd.js"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Mermaid.js for Class Diagram -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>

<body>

    <!-- ================================
         화면 1: 초기 업로드 화면
    ================================ -->
    <section id="uploadScreen" class="screen active">
        <div class="upload-container">
            <h1>⚡ JavaScript Code Parsing + AST Summary</h1>

            <label for="zipUpload" id="dropZone" class="upload-box">
                <p class="upload-icon">📦</p>
                <p class="upload-text">ZIP 파일 업로드 또는 드래그 앤 드롭</p>
                <p class="upload-hint">(JavaScript 파일 포함)</p>
                <button id="fileButton" type="button" class="file-select-btn">파일 선택</button>
            </label>

            <input type="file" id="zipUpload" accept=".zip">
        </div>
    </section>

    <!-- ================================
         화면 2: 로딩 화면
    ================================ -->
    <section id="loadingScreen" class="screen">
        <div class="loading-container">
            <div class="loader">
                <div class="loader-ring"></div>
                <div class="loader-ring"></div>
                <div class="loader-ring"></div>
            </div>
            <p class="loading-text">AST 파싱 중...</p>
            <p class="loading-subtext" id="loadingFileName"></p>
        </div>
    </section>

    <!-- ================================
         화면 3: 결과 화면 (좌/우 분할)
    ================================ -->
    <section id="resultScreen" class="screen">
        <!-- 상단 헤더 -->
        <header class="result-header">
            <h1>⚡ AST 분석 결과</h1>
            <div class="header-buttons">
                <button id="toggleViewBtn" class="toggle-view-btn">📐 다이어그램 보기</button>
                <button id="newAnalysisBtn" class="new-analysis-btn">+ 새 분석</button>
            </div>
        </header>

        <!-- 메인 컨텐츠 (좌/우 분할) -->
        <div class="result-container">
            
            <!-- 좌측: 분석 결과 -->
            <div class="result-left">
                <div id="summaryBox" class="summary-box">
                    <!-- 분석 결과가 여기에 표시됩니다 -->
                </div>

                <!-- 차트 영역 -->
                <div class="charts-container" id="chartsContainer">
                    <!-- 상단 차트 row -->
                    <div class="chart-row">
                        <div class="chart-card">
                            <div class="chart-title">🎯 코드 품질 점수</div>
                            <canvas id="qualityGaugeChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <div class="chart-title">📊 품질 지표 분석</div>
                            <canvas id="qualityBarChart"></canvas>
                        </div>
                    </div>

                    <!-- 중단 차트 row -->
                    <div class="chart-row">
                        <div class="chart-card wide">
                            <div class="chart-title">📈 확장 메트릭 레이더</div>
                            <canvas id="metricsRadarChart"></canvas>
                        </div>
                    </div>

                    <!-- 하단 차트 row -->
                    <div class="chart-row">
                        <div class="chart-card">
                            <div class="chart-title">🔥 복잡도 분포</div>
                            <canvas id="complexityDoughnutChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <div class="chart-title">📉 메트릭 상세</div>
                            <canvas id="metricsBarChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- 클래스 다이어그램 영역 (기본 숨김) -->
                <div class="diagram-container" id="diagramContainer" style="display: none;">
                    <div class="diagram-card">
                        <div class="diagram-title">📐 클래스 다이어그램</div>
                        <div class="diagram-content" id="classDiagram"></div>
                    </div>
                    
                    <div class="diagram-card">
                        <div class="diagram-title">🔗 함수 호출 관계</div>
                        <div class="diagram-content" id="callDiagram"></div>
                    </div>

                    <div class="diagram-card">
                        <div class="diagram-title">📋 구조 요약</div>
                        <div class="structure-summary" id="structureSummary"></div>
                    </div>
                </div>
            </div>

            <!-- 우측: AST JSON -->
            <div class="result-right">
                <div class="code-section">
                    <div class="code-title">
                        <span>📄 app.js AST (Meriyah 파싱 결과)</span>
                    </div>
                    <div id="result" class="code-box"></div>
                </div>

                <!-- ZIP 내부 ast.json (있을 경우) -->
                <div class="code-section" id="astJsonSection" style="display:none;">
                    <div class="code-title">
                        <span>📁 ZIP 내부 ast.json</span>
                    </div>
                    <div id="astJsonBox" class="code-box"></div>
                </div>
            </div>

        </div>
    </section>

    <!-- External JavaScript -->
    <script src="app.js"></script>

</body>
</html>